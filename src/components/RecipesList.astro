---
import { RecipeType, type Recipe } from "../shared/models";

type RecipeFile = {
    fileUrl: string;
    recipe: Recipe;
};

const files = import.meta.glob("../recipes/*.json", { eager: true });
const entries = Object.entries(files);

const recipes: RecipeFile[] = [];

for (const [path, module] of entries as [string, Recipe][]) {
    const fullFileName = path;

    // strip everything before last /
    const fileName = fullFileName.substring(fullFileName.lastIndexOf("/") + 1);

    // remove .json
    const fileUrl = fileName.substring(0, fileName.length - 5);

    recipes.push({ fileUrl, "recipe": module});
}

---

<div class="container">
    <main>
        <h3>Recipe List</h3>

        <h6>Mains</h6>
        <ul>
            {
                recipes.filter(recipe=>recipe.recipe.type == RecipeType.Main).map((recipe) => (
                    <li>
                        <a href={`./recipes/${recipe.fileUrl}`}>{recipe.recipe.name}</a>
                    </li>
                ))
            }
        </ul>

        <h6>Protein</h6>
        <ul>
            {
                recipes.filter(recipe=>recipe.recipe.type == RecipeType.Protein).map((recipe) => (
                    <li>
                        <a href={`./recipes/${recipe.fileUrl}`}>{recipe.recipe.name}</a>
                    </li>
                ))
            }
        </ul>

        <h6>Pasta</h6>
        <ul>
            {
                recipes.filter(recipe=>recipe.recipe.type == RecipeType.Pasta).map((recipe) => (
                    <li>
                        <a href={`./recipes/${recipe.fileUrl}`}>{recipe.recipe.name}</a>
                    </li>
                ))
            }
        </ul>

        <h6>Soup</h6>
        <ul>
            {
                recipes.filter(recipe=>recipe.recipe.type == RecipeType.Soup).map((recipe) => (
                    <li>
                        <a href={`./recipes/${recipe.fileUrl}`}>{recipe.recipe.name}</a>
                    </li>
                ))
            }
        </ul>

        <h6>Misc</h6>
        <ul>
            {
                recipes.filter(recipe=>recipe.recipe.type == RecipeType.Misc).map((recipe) => (
                    <li>
                        <a href={`./recipes/${recipe.fileUrl}`}>{recipe.recipe.name}</a>
                    </li>
                ))
            }
        </ul>
    </main>
</div>

<style>
    main {
        padding-bottom: 2rem;
    }
</style>

<!-- 
### Mains
 - [Beef Bulgogi](./recipes/beef-bulgogi.md)
 - [Coq Au Vin](./recipes/coq-au-vin.md)
 - [Smash Burgers](./recipes/smash-burgers.md)
 - [White Win Chicken and Potatoes](./recipes/white-wine-chicken-and-potatoes.md)

### Pasta
 - [Pasta Primavera](./recipes/pasta-primavera.md)
 - [Red Sauce](./recipes/red-sauce.md)

### Proteins
 - [Bacon Wrapped Smokies](./recipes/bacon-wrapped-smokies.md)
 - [Beer Battered Fish](./recipes/beer-battered-fish.md)
 - [Fried Chicken](./recipes/fried-chicken.md)
 - [Pork Shoulder](./recipes/pork-shoulder.md)
 - [Pork Tenderloin](./recipes/pork-tenderloin.md)
 - [Ribs](./recipes/ribs.md)

### Soup
 - [Chicken Gnocchi Soup](./recipes/chicken-gnocchi-soup.md)
 - [Roasted Tomato Soup](./recipes/roasted-tomato-soup.md)

### Miscellaneous
 - [All Purpose Seasoning](./recipes/all-purpose-seasoning.md)
 - [Burger Sauce](./recipes/burger-sauce.md)
 - [Hummus](./recipes/hummus.md)
 - [Tartar Sauce](./recipes/tartar-sauce.md) -->
